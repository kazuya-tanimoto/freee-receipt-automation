# 開発ガイドライン

## 目的

このディレクトリには、freee経費管理自動化プロジェクトの開発ガイドラインが含まれています。これらのガイドラインは、プロジェクトに携わる開発者とAIアシスタントの両方のために、一貫したコーディング規約と標準を確立することを目的としています。

ガイドラインには主に以下の2つのリソースが含まれています：

- **Bulletproof React**：スケーラブルで保守性の高いReactアプリケーションを構築するための包括的なガイド。プロジェクト構造、状態管理、テストなどをカバーしています。
- **Naming Cheatsheet**：変数、関数、その他のコード要素を一貫性を持って直感的に命名するためのガイド。

これらのガイドラインはGitサブモジュールとして統合されており、上流リポジトリとの同期を容易に保ちながら、プロジェクトの安定したリファレンスを維持することができます。SUMMARY.mdファイルは、両方のガイドラインの主要なポイントを簡潔に要約し、2000トークンの制限内でAIコンテキスト用に最適化されています。

## ディレクトリ構造

```
guidelines/
├── SUMMARY.md                # AI向け要約（2000トークン制限）
├── README.md                 # 英語版ドキュメント
├── README_JA.md              # 日本語版ドキュメント（このファイル）
├── bulletproof-react/        # Gitサブモジュール
└── naming-cheatsheet/        # Gitサブモジュール
```

## メンテナンス手順

### 更新スクリプトの使用方法

ガイドラインの更新プロセスを簡素化するためのスクリプトを提供しています：

```bash
./scripts/update-guidelines.sh
```

このスクリプトは以下の操作を実行します：
1. `git submodule update --remote --merge`を使用して、すべてのGitサブモジュールを最新バージョンに更新します
2. mdformatを使用してSUMMARY.mdファイルをフォーマットし、一貫したスタイルを確保します

### 手動更新プロセス

ガイドラインを手動で更新する必要がある場合：

1. サブモジュールを更新します：
   ```bash
   git submodule update --remote --merge
   ```

2. SUMMARY.mdファイルをフォーマットします（Node.jsが必要です）：
   ```bash
   npx mdformat docs/guidelines/SUMMARY.md
   ```

3. 変更を確認し、SUMMARY.mdファイルが2000トークンの制限を守っていることを確認します

### 自動週次更新

GitHub Actionsワークフローにより、更新スクリプトが週次で自動的に実行され、変更があれば自動的にプルリクエストが作成されます。これにより、手動介入なしでガイドラインを最新の状態に保つことができます。

### 変更の記録

ガイドラインを更新した後は、Keep a Changelogフォーマットに従って、CHANGELOG.mdファイルの適切なバージョンセクションに変更を記録してください：

```markdown
## [Unreleased]

### Changed

- ガイドラインを更新：
  - Bulletproof ReactをバージョンX.Y.Zに更新
  - Naming Cheatsheetを最新バージョンに更新
  - SUMMARY.mdを修正して新しい推奨事項を追加
```

## 重要な注意事項

- **SUMMARY.mdを直接編集しないでください**。このファイルは、適切なフォーマットとトークン制限を確保するために、更新スクリプトを通じてのみ更新されるべきです。

- **ガイドラインの変更はチームと共有してください**。ガイドラインに重要な更新が行われた場合は、チームに通知し、プロジェクトのアーキテクチャに影響を与える変更については、アーキテクチャ決定記録（ADR）の作成を検討してください。

- **トークン制限は重要です**。SUMMARY.mdの2000トークン制限は、AI連携の最適化のために重要です。この制限を超えると、AIアシスタンスの効果が低下する可能性があります。

- **システムプロンプトとの統合**。SUMMARY.mdファイルは、開発標準に関するコンテキストを提供するために、AIシステムプロンプトに統合されるよう設計されています。

## CI/CD 統合

### GitHub Actionsワークフロー

ガイドラインは、GitHub Actionsを通じてCI/CDパイプラインに統合されています：

- 週次ワークフローにより、サブモジュールが自動的に更新され、プルリクエストが作成されます
- ワークフローは、SUMMARY.mdファイルが2000トークンの制限内に収まっていることを確認します
- ワークフローは、変更をCHANGELOG.mdファイルに自動的に更新します

### プルリクエストプロセス

自動化されたPRが作成された場合：
1. チームによって変更がレビューされます
2. SUMMARY.mdに必要な調整が行われます
3. 承認後、PRがマージされます

## 貢献方法

### ガイドラインへの変更提案

ガイドラインの使用方法に変更を提案したい場合：

1. 提案する変更とその利点を説明する課題（Issue）を作成します
2. チームと議論して合意を得ます
3. 合意された変更を反映するためにSUMMARY.mdファイル（更新スクリプトを介して）を更新します
4. 変更を含むプルリクエストを作成します

### 上流リポジトリとの関係

私たちのガイドラインは上流リポジトリに基づいていますが、特定のニーズに合わせて適応させることがあります。貢献する際は：

- 変更を上流リポジトリに提案すべきかどうかを検討してください
- 変更を行う際は後方互換性を確保してください
- プロジェクト固有の適応は明確に文書化してください

### プロジェクト固有のガイドライン

外部リソースでカバーされていないプロジェクト固有のガイドラインについては：

1. 明確にマークされたセクションでSUMMARY.mdファイルに追加します
2. 文書の残りの部分と同じスタイルとフォーマットに従っていることを確認します
3. 簡潔に保ち、トークン制限内に収めてください

### 後方互換性

ガイドラインを更新する際は、既存のコードへの影響を考慮してください：

- 既存のコードの大幅なリファクタリングを必要とする変更は避けてください
- 破壊的変更が必要な場合は、移行パスを提供してください
- 非推奨となった慣行については、その代替手段とともに文書化してください