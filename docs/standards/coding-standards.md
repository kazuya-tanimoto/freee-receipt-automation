# Coding Standards

## Overview

This document defines the standards for maintaining code quality in the project.

## Code Style

### 1. Naming Conventions

- Variable names: camelCase (e.g., `userName`)
- Function names: camelCase (e.g., `getUserData`)
- Class names: PascalCase (e.g., `UserService`)
- Constants: UPPER_SNAKE_CASE (e.g., `MAX_RETRY_COUNT`)

### 2. File Structure

- Line count limits per file:
  - Basic limit: 150 lines
  - Absolute limit: 250 lines
  - If exceeding 150 lines, the following actions must be taken:
    - Split functionality (divide into multiple files)
    - Extract common processes
    - Separate utility functions
  - If exceeding 250 lines, code redesign is required
- Exceptions where exceeding 250 lines is allowed:
  - Test files (when there are many test cases)
  - Data structure or type definition files
  - Auto-generated code (only if the following conditions are met):
    - Generated code must be split if possible
    - Each part of generated code must be within 150 lines
    - Each part must have a single responsibility
    - Generated code must be properly documented

### 3. AI Agent Code Generation

- Code generated by AI agents must be kept within 150 lines
- If exceeding 150 lines, split according to the following criteria:
  - Split by functionality
  - Each part must be within 150 lines
  - Each part must have a single responsibility
  - Purpose and behavior of each part must be clearly explained
- Quality checks for generated code:
  - Conduct code review
  - Ensure test coverage
  - Verify performance and security
  - Confirm compliance with line count limits

### 3. Comment Standards

- Function descriptions: JSDoc format
- Complex logic: Inline comments
- TODO comments: Include deadline and assignee

## Code Quality

### 1. Testing Strategy

#### Test Architecture: Unit + E2E

This project follows a two-tier testing approach optimized for individual development:

#### Unit Tests

- **Location**: Co-located with source files (`src/lib/auth.ts` â†’ `src/lib/auth.test.ts`)
- **Framework**: Vitest + Testing Library + MSW
- **Scope**: Individual functions, components, business logic
- **Coverage**: Focus on critical paths rather than percentage targets

#### E2E Tests

- **Location**: Dedicated `e2e/` directory
- **Framework**: Playwright
- **Scope**: Complete user workflows and critical journeys
- **Coverage**: Essential application functionality

#### Testing Standards

- Test file naming: `*.test.ts` for unit tests, `*.spec.ts` for E2E tests
- Mock usage: Use MSW for API mocking, avoid over-mocking
- Test isolation: Each test should be independent
- Descriptive naming: Test names should describe behavior, not implementation

### 2. Error Handling

- Exception handling: Specify concrete exception types
- Error messages: User-friendly
- Logging: Use appropriate log levels

### 3. Performance

- Asynchronous processing: Proper use of Promise/async-await
- Memory management: Release unnecessary references
- Database queries: Utilize indexes

## Security

### 1. Input Validation

- User input: Appropriate validation
- SQL injection prevention: Parameterized queries
- XSS prevention: Escape processing

### 2. Authentication & Authorization

- Passwords: Hashing
- Session management: Appropriate timeouts
- Access control: Principle of least privilege

## Reference Links

- [Project Root README](../../README.md)
- [AI Context Optimization](../../ai/context/context-optimization.md)
- [Operational Guidelines](../ops/operational-guidelines.md)
- [Review Guidelines](./review-guidelines.md)
