# PBI-2-3-3: Google Driveビジネスロジック統合

## 説明

Google
Drive操作を領収書処理ワークフローのコアビジネスロジックと統合します。これには、取引データに基づくファイル整理、OCR結果との統合、および適切なファイル関連付けを維持するためのfreee
APIデータとの調整が含まれます。

## 実装詳細

### 作成/修正するファイル

1. `src/services/drive-receipt-organizer.ts` - メイン整理サービス
2. `src/lib/drive/file-metadata.ts` - 領収書用カスタムプロパティ
3. `src/lib/drive/transaction-linker.ts` - ファイルを取引にリンク
4. `src/services/drive-workflow.ts` - 完全なDriveワークフロー
5. `src/lib/drive/search-utilities.ts` - 高度な検索機能
6. `docs/drive/business-logic.md` - ビジネスロジックドキュメント

### 技術要件

- 領収書メタデータに基づいてファイルを整理
- ファイルプロパティに取引IDを保存
- 複数の条件によるファイル検索をサポート
- ファイルと取引の関係を維持
- フォルダー間のファイル移動を処理

### 実装コード

- 領収書整理サービス
- ファイルメタデータ管理
- 取引リンクロジック
- 検索機能
- ワークフロー実装

## メタデータ

- **ステータス**: 未開始
- **実際のストーリーポイント**: [完了後に記入]
- **作成日**: 2025-06-05
- **開始日**: [日付]
- **完了日**: [日付]
- **所有者**: [AIアシスタントIDまたは人間]
- **レビュアー**: [このPBIをレビューした人]
- **実装メモ**: [完了後の学び]

## 受け入れ基準

- [ ] ファイルが日付とベンダーごとに整理される
- [ ] 取引IDがファイルメタデータに保存される
- [ ] ファイル検索が複数の条件で機能する
- [ ] ファイルと取引のリンクが維持される
- [ ] ファイル移動が関係を保持する
- [ ] ワークフローがすべてのエッジケースを処理する

## 依存関係

- **必須**: PBI-2-3-1 - Drive OAuth設定
- **必須**: PBI-2-3-2 - Drive基本API操作
- **必須**: PBI-2-4-2 - フォルダー構造管理

## テスト要件

- ユニットテスト: 整理ロジック
- 統合テスト: 完全なワークフローシナリオ
- パフォーマンステスト: 大量ファイルバッチ
- エッジケース: 重複ファイル、欠落メタデータ

## 見積もり

2ストーリーポイント

## 優先度

高 - コアビジネスロジック実装
